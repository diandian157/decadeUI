import{ui,lib,game}from"noname";function e(){!function(){if(document.getElementById("decade-welcome-styles"))return;const e=document.createElement("link");e.id="decade-welcome-styles",e.rel="stylesheet",e.href=`${lib.assetURL}extension/十周年UI/src/features/welcomeDialog.css`,document.head.appendChild(e)}();const e=ui.create.div(".decade-welcome-overlay"),t=ui.create.div(".decade-welcome-dialog",e);ui.create.div(".decade-welcome-pattern",t);const n=document.createElement("img");n.src=`https://q1.qlogo.cn/g?b=qq&nk=2173890060&s=100&t=${Date.now()}`,n.className="author-avatar";let i=!1,l="";n.addEventListener("click",async()=>{if(i)c.innerHTML=l,o.innerHTML="点我查看更新内容",i=!1,c.scrollTop=0;else try{const e=await fetch(`${decadeUIPath}docs/update.md`);let t=(await e.text()).replace(/^# (.+)$/gm,'<h1 style="font-size: 22px; margin: 8px 0 5px 0; color: #fff; font-weight: bold;">$1</h1>').replace(/^## (.+)$/gm,'<h2 style="font-size: 19px; margin: 6px 0 4px 0; color: #fff; font-weight: bold;">$1</h2>').replace(/^### (.+)$/gm,'<h3 style="font-size: 17px; margin: 5px 0 3px 0; color: #fff; font-weight: bold;">$1</h3>').replace(/^\d+\.\s+(.+)$/gm,'<li style="margin: 2px 0; color: #fff; line-height: 1.5; font-size: 15px;">$1</li>').replace(/^- (.+)$/gm,'<li style="margin: 2px 0; color: #fff; line-height: 1.5; font-size: 15px;">$1</li>').replace(/\[(.+?)\]\((.+?)\)/g,'<a href="$2" style="color: #ffd700; text-decoration: underline;">$1</a>').replace(/\n\n/g,"<br>");t=t.replace(/(<li[^>]*>.*?<\/li>\s*)+/gs,'<ul style="margin: 3px 0 5px 15px; padding-left: 15px; color: #fff;">$&</ul>'),c.innerHTML=t,o.innerHTML="点我返回前言",i=!0,c.scrollTop=0}catch(e){c.innerHTML='<p style="color: #fff; text-align: center;">更新日志加载失败 (´；ω；`)</p>'}}),t.appendChild(n);const o=ui.create.div(".decade-welcome-bubble",t);o.innerHTML="点我查看更新内容";const c=ui.create.div(".decade-welcome-text",t);c.innerHTML='\n\t\t<p style="margin: 0 0 15px 0;">\n\t\t\t这条信息，只有二次元の朋友们才能看见哟(°°)。\n\t\t</p>\n\t\t<p style="margin: 0 0 15px 0;">\n\t\t\t诶多诶多，希望收到这条信息的由纪，在新的一年里，能像二次元里的大家一样，天☆天☆开☆心☆喵~(=^▽^=) kira(∗＞∀❛ั❛)✧*，瓦达西，对……大家sukisukidaisuki！(≧ω≦)/。\n\t\t</p>\n\t\t<p style="margin: 0 0 15px 0;">\n\t\t\t还有，2026年，一定要和二次元の米娜桑继续在一起哟，不可以变成坏！现！充！（ᗜ ˰ ᗜ）啊嘞？已经不喜欢二次元了吗（失望的眼神）……诶多，呆胶布的( • ˍ • * * *•• *•• * )。\n\t\t</p>\n\t\t<p style="margin: 0 0 15px 0;">\n\t\t\t希望由纪能带着二次元の米娜桑的祝福魔法「magic」，在三次元の世界里，当一个加把劲骑士「knight」。还有，要当好现充，和二次元的大家和睦相处哟（坏现充是要被「魔法少女」teriteri掉的！）。\n\t\t</p>\n\t\t<p style="margin: 15px 0 0 0; font-weight: bold; text-align: center; font-size: 16px;">\n\t\t\t好啦，米娜桑！(*^ω^*)新的一年，从美妙的邂逅开始♬\n\t\t</p>\n\t',l=c.innerHTML,lib.setScroll(c),e.addEventListener("click",t=>{t.target===e&&e.remove()}),document.body.appendChild(e)}function t(t){(function(e){const t="extension_十周年UI_welcomeVersion",n=lib.config[t],i=e.version;return!(n&&n===i||(game.saveConfig(t,i),0))})(t)&&setTimeout(()=>{e()},1e3)}export{e as createWelcomeDialog,t as setupWelcomeDialog};
