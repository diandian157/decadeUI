import{ui,game,lib,_status}from"noname";const n="extension_十周年UI_closedExtensions",e=()=>{const n=window.decadeUIName||"十周年UI",e=_status.PROTECTED_EXTENSIONS??[];return(lib.config.extensions||[]).filter(o=>o!==n&&!e.includes(o))},o=()=>{const e=lib.config[n];return Array.isArray(e)?e:[]},t=()=>o().length>0,s=()=>t()?"恢复其他扩展":"关闭其他扩展",i=()=>{const s=t(),i=s?o():e().filter(n=>lib.config[`extension_${n}_enable`]);if(0===i.length)return void alert(s?"没有需要恢复的扩展":"没有其他已启用的扩展");const r=s?"恢复其他":"关闭其他",a=i.map(n=>`· ${n}`).join("\n");confirm(`确定${r}以下 ${i.length} 个扩展？\n\n${a}\n\n将自动重启游戏。`)&&(s?(i.forEach(n=>{lib.config.extensions?.includes(n)&&game.saveConfig(`extension_${n}_enable`,!0)}),game.saveConfig(n,[])):(game.saveConfig(n,i),i.forEach(n=>game.saveConfig(`extension_${n}_enable`,!1))),setTimeout(()=>game.reload(),100))};function r(){window.decadeUI&&(window.decadeUI.toggleExtensions=i);const e=setInterval(()=>{if(!ui.system1&&!ui.system2)return;clearInterval(e);const o=ui.create.system(s(),i,!0),t=game.saveConfig;game.saveConfig=function(e){const result=t.apply(this,arguments);return e===n&&(o.innerHTML=s()),result}},500)}export{r as setupExtensionToggle};
