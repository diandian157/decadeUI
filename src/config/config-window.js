import{ui,lib,game}from"noname";import{config as e}from"./index.js";let t=null;function n(){if(t)return;!function(){if(document.getElementById("decade-config-window-styles"))return;const e=document.createElement("link");e.id="decade-config-window-styles",e.rel="stylesheet",e.href=`${lib.assetURL}extension/十周年UI/src/config/config-window.css`,document.head.appendChild(e)}();const e=ui.create.div(".decade-config-overlay"),n=ui.create.div(".decade-config-dialog",e);ui.create.div(".decade-config-pattern",n);ui.create.div(".decade-config-title",n).innerHTML="十周年UI配置中心";const i=document.createElement("img");i.src=`https://q1.qlogo.cn/g?b=qq&nk=2173890060&s=100&t=${Date.now()}`,i.className="decade-config-avatar",i.onclick=()=>{e.remove(),t=null},n.appendChild(i);const c=ui.create.div(".decade-config-sidebar",n),o=ui.create.div(".decade-config-content",n);let d="appearance";[{id:"appearance",name:"整体外观"},{id:"card",name:"卡牌相关"},{id:"component",name:"部件管理"},{id:"misc",name:"其他设置"}].forEach(e=>{const t=ui.create.div(".decade-config-tab",c);t.innerHTML=e.name,e.id===d&&t.classList.add("active"),t.onclick=()=>{d!==e.id&&(d=e.id,Array.from(c.children).forEach(e=>{e.classList.remove("active")}),t.classList.add("active"),a(o,d))}}),a(o,d),e.addEventListener("click",n=>{n.target===e&&(e.remove(),t=null)}),document.body.appendChild(e),t=e}function a(t,n){t.innerHTML="",t.scrollTop=0;const a=function(e){return{appearance:[{isTitle:!0,name:"样式设置"},{key:"newDecadeStyle",name:"切换样式",type:"select"},{key:"outcropSkin",name:"露头样式",type:"select"},{key:"borderLevel",name:"等阶边框",type:"select"},{isTitle:!0,name:"功能开关"},{key:"aloneEquip",name:"单独装备栏",type:"toggle"},{key:"meanPrettify",name:"菜单美化",type:"toggle"},{key:"dynamicSkin",name:"动态皮肤",type:"toggle"},{key:"dynamicSkinOutcrop",name:"动皮露头",type:"toggle"},{key:"killEffect",name:"击杀特效",type:"toggle"}],card:[{isTitle:!0,name:"卡牌效果"},{key:"cardGhostEffect",name:"幻影出牌",type:"toggle"},{key:"autoSelect",name:"自动选择",type:"toggle"},{key:"cardPrompt",name:"出牌信息提示",type:"toggle"},{isTitle:!0,name:"卡牌样式"},{key:"cardPrettify",name:"卡牌美化",type:"select"},{key:"cardkmh",name:"卡牌边框",type:"select"},{key:"chupaizhishi",name:"出牌指示",type:"select"},{isTitle:!0,name:"尺寸调整"},{key:"cardScale",name:"手牌大小",type:"input"},{key:"discardScale",name:"弃牌堆卡牌大小",type:"input"},{key:"handTipHeight",name:"出牌信息提示高度",type:"input"},{key:"handFoldMin",name:"手牌折叠",type:"input"}],component:[{isTitle:!0,name:"进度条设置"},{key:"jindutiaoYangshi",name:"进度条样式",type:"select"},{key:"jindutiaoST",name:"进度条速度",type:"select"},{key:"jindutiaoSet",name:"进度条高度",type:"input"},{isTitle:!0,name:"界面元素"},{key:"JDTSYangshi",name:"阶段提示",type:"select"},{key:"GTBBYangshi",name:"狗托播报",type:"select"},{key:"GTBBFont",name:"播报字体",type:"select"},{key:"GTBBTime",name:"时间间隔",type:"select"},{key:"playerMarkStyle",name:"标记样式",type:"select"},{key:"loadingStyle",name:"光标+loading框",type:"select"},{key:"gainSkillsVisible",name:"获得技能显示",type:"select"}],misc:[{isTitle:!0,name:"音效与视觉"},{key:"bettersound",name:"更多音效",type:"toggle"},{key:"skillDieAudio",name:"中二模式",type:"toggle"},{key:"wujiangbeijing",name:"武将背景",type:"toggle"},{key:"shiliyouhua",name:"官方势力",type:"toggle"},{isTitle:!0,name:"游戏功能"},{key:"enableRecastInteraction",name:"重铸交互",type:"toggle"},{key:"mx_decade_characterDialog",name:"自由选将筛选框",type:"select"},{key:"rightLayout",name:"左右布局",type:"select"},{key:"eruda",name:"调试助手",type:"toggle"}]}[e]||[]}(n);a.forEach(n=>{if(n.isTitle){return void(ui.create.div(".decade-config-section-title",t).innerHTML=n.name)}const a=`extension_十周年UI_${n.key}`,i=e[n.key];if(!i)return;const c=ui.create.div(".decade-config-item",t),o=document.createElement("table");o.className="decade-config-table";const d=document.createElement("tr"),l=document.createElement("td");l.className="decade-config-name",l.innerHTML=n.name;let s=null;i.intro&&(s=document.createElement("div"),s.className="decade-config-intro",s.innerHTML=i.intro,l.onclick=function(e){e.stopPropagation(),s.classList.toggle("show")});const m=document.createElement("td");if(m.className="decade-config-control","toggle"===n.type){const e=lib.config[a],t=void 0!==e?e:i.init,n=document.createElement("div");n.className="decade-config-toggle "+(t?"on":"off");const c=document.createElement("div");c.className="decade-config-toggle-slider",n.appendChild(c),n.onclick=function(){const e=!lib.config[a];game.saveConfig(a,e),n.className="decade-config-toggle "+(e?"on":"off"),i.onclick?i.onclick(e):i.update&&i.update()},m.appendChild(n)}else if("select"===n.type){const e=lib.config[a]??i.init,t=document.createElement("div");t.className="decade-config-options",Object.keys(i.item).forEach(n=>{const c=document.createElement("div");c.className="decade-config-option",n===e?(c.classList.add("selected"),c.style.cssText="margin-right: 8px; margin-bottom: 8px; box-shadow: 0 2px 8px rgba(168, 237, 234, 0.4) !important;"):c.style.cssText="margin-right: 8px; margin-bottom: 8px; box-shadow: none !important;";let o=i.item[n];if("string"==typeof o&&o.includes("<")){const e=document.createElement("div");e.innerHTML=o;o=(e.textContent||e.innerText).trim()||n}c.textContent=o,c.dataset.value=n,c.onclick=function(){if(this.dataset.value===lib.config[a])return;Array.from(t.children).forEach(e=>{e.classList.remove("selected"),e.style.cssText="margin-right: 8px; margin-bottom: 8px; box-shadow: none !important;"}),this.classList.add("selected"),this.style.cssText="margin-right: 8px; margin-bottom: 8px; box-shadow: 0 2px 8px rgba(168, 237, 234, 0.4) !important;";const e=this.dataset.value;i.onclick?i.onclick(e):(game.saveConfig(a,e),i.update&&i.update())},t.appendChild(c)}),m.appendChild(t)}else if("input"===n.type){const e=document.createElement("input");e.type="text",e.className="decade-config-input",e.value=lib.config[a]??i.init,e.addEventListener("blur",function(){const e=this.value.trim();e&&(i.onblur?i.onblur.call(this):game.saveConfig(a,e),i.update&&i.update())}),e.addEventListener("keydown",function(e){"Enter"===e.key&&this.blur()}),m.appendChild(e)}if(d.appendChild(l),d.appendChild(m),o.appendChild(d),s){const e=document.createElement("tr"),t=document.createElement("td");t.colSpan=2,t.appendChild(s),e.appendChild(t),o.appendChild(e)}c.appendChild(o)})}function i(){n()}function c(){t&&(t.remove(),t=null)}export{c as hideDecadeConfigWindow,i as showDecadeConfigWindow};
