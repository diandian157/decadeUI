import{ui}from"noname";const e=()=>({updates:[],canvas:null,frameId:null,frameTime:null,check(){return!!ui.arena&&(this.canvas||(this.canvas=ui.arena.appendChild(document.createElement("canvas")),this.canvas.id="decadeUI-canvas-arena"),!0)},add(e,...t){"function"==typeof e&&this.check()&&(this.updates.push({update:e,inits:t.slice(1),id:decadeUI.getRandom(0,100)}),this.frameId||(this.frameId=requestAnimationFrame(this.update.bind(this))))},update(){const e=performance.now(),t=e-(this.frameTime??e);this.frameTime=e;const a=function(e,t){const a=e.getContext("2d");return{canvas:e,context:a,deltaTime:t,save:()=>(a.save(),a),restore:()=>(a.restore(),a),drawLine(e,t,s,i,n,d){a.beginPath(),n&&(a.strokeStyle=n),d&&(a.lineWidth=d),null==s||null==i?a.lineTo(e,t):(a.moveTo(e,t),a.lineTo(s,i)),a.stroke()},drawRect(e,t,s,i,n,d){a.beginPath(),n&&(a.strokeStyle=n),d&&(a.lineWidth=d),a.rect(e,t,s,i),a.stroke()},fillRect(e,t,s,i,n){n&&(a.fillStyle=n),a.fillRect(e,t,s,i)},drawText(e,t,s,i,n,d,l,r=!1){e&&null!=i&&null!=n&&(t&&(a.font=t),d&&(a.textAlign=d),l&&(a.textBaseline=l),s&&(a[r?"strokeStyle":"fillStyle"]=s),a[r?"strokeText":"fillText"](e,i,n))},drawStrokeText(e,t,a,s,i,n,d){this.drawText(e,t,a,s,i,n,d,!0)}}}(this.canvas,t);decadeUI.dataset.animSizeUpdated||(decadeUI.dataset.animSizeUpdated=!0,this.canvas.width=this.canvas.parentNode.offsetWidth,this.canvas.height=this.canvas.parentNode.offsetHeight),this.canvas.height=this.canvas.height;for(let s=this.updates.length-1;s>=0;s--){const e=this.updates[s];a.save();const t=e.update.apply(e,[...e.inits,a]);a.restore(),t&&this.updates.splice(s,1)}this.updates.length>0?this.frameId=requestAnimationFrame(this.update.bind(this)):(this.frameId=null,this.frameTime=null)}});export{e as createDecadeUIAnimateModule};
