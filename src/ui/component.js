import{game,lib,_status}from"noname";function e(e=0,n=100,t){const o=document.createElement("input");o.className="slider",o.type="range",o.min=e,o.max=n;const c=()=>{const e=(o.value-o.min)/(o.max-o.min)*100;o.style.backgroundSize=`${e}% 100%`},a=Object.getOwnPropertyDescriptor(o.__proto__,"value");return Object.defineProperty(o,"value",{configurable:!0,get:()=>a.get.call(o),set:e=>{a.set.call(o,e),c()}}),o.addEventListener("input",c),o.value=t??.5*(n-e),o}function n(e){const{dialog:n}=e,t=n.create("chat-box folded");t.container=n.create("container",t),t.operation=n.create("operation",t),t.content=n.create("content",t.container);const o=t.operation;o.fold=n.create("fold-button",o,"button"),o.input=n.create("chat-input",o,"input"),o.sticker=n.create("sticker-button",o,"button"),o.send=n.create("send-button",o,"button"),o.fold.innerHTML="…",o.sticker.innerHTML="表情",o.send.innerHTML="发送";const c=o.input;t.addEntry=e=>{n.create("chat-text",t.content).innerHTML=`<span class="sender">${e[0]}</span>:<span class="text">${e[1]}</span>`,t.overrideEntry?.(e),t.content.scrollTop=t.content.scrollHeight},t.addEntry._origin=t;return t.sendInputText=()=>{const e=c.value;if(!e)return;const player=game.me?game.me:game.connectPlayers?game.online?game.connectPlayers.find(e=>e.playerid===game.onlineID)||null:game.connectPlayers[0]:null;player&&(game.online?game.send("chat",game.onlineID,e):lib.element.player.chat.call(player,e),c.value="",_status.chatValue="")},o.fold.addEventListener("click",()=>{const e=t.classList.toggle("folded");o.fold.innerHTML=e?"…":"<<"}),o.send.addEventListener("click",()=>{t.sendInputText(),c.focus()}),c.addEventListener("change",()=>{_status.chatValue=c.value}),c.addEventListener("keydown",e=>{13===e.keyCode&&t.sendInputText(),e.stopPropagation()}),t}function t(t){t.component={slider:e,chatBox:()=>n(t)}}export{n as createChatBox,e as createSlider,t as initComponent};
