import{game,lib,_status,get}from"noname";const e=()=>{game.as_removeImage(),_status.as_showImage_phase&&game.showJDTsImage(_status.as_showImage_phase,!0)},s=player=>player===game.me,a=player=>s(player)&&_status.currentPhase===player,r=()=>!_status.auto,t=[["phaseBegin","hhks","hhks"],["phaseZhunbeiBefore","pdjd","zbjd"],["phaseJudgeBefore","pdjd","pdjd"],["phaseDrawBefore","mpjd","mpjd"],["phaseUseBefore","cpjd","cpjd"],["phaseDiscardBefore","qpjd","qpjd"],["phaseJieshuBefore","pdjd","jsjd"],["phaseEnd","hhjs","hhjs"]],n=[["phaseZhunbeiAfter","zbjd"],["phaseJudgeAfter","pdjd"],["phaseDrawAfter","mpjd"],["phaseUseAfter","cpjd"],["phaseDiscardAfter","qpjd"],["phaseJieshuAfter","jsjd"],["phaseAfter","hhjs"]];function d(){const d=()=>"0"!==lib.config.extension_十周年UI_JDTSYangshi;game.showJDTsImage=(e,s)=>{d()&&game.as_showImage((e=>`extension/十周年UI/ui/assets/lbtn/tips/${e}.${{2:"png",3:"webp",4:"jpeg"}[lib.config.extension_十周年UI_JDTSYangshi]||"jpg"}`)(e),(()=>{if("1"===lib.config.extension_十周年UI_JDTSYangshi)return"taixuhuanjing"===get.mode()||lib.config.extension_EngEX_SSServant?[10,58,7,6]:[3,58,7,6];return[18,65,8,4.4]})(),s)},lib.onover.push(()=>game.as_removeImage()),t.forEach(([event,e,s])=>{lib.skill[`_jdts_${event}`]={trigger:{player:event},silent:!0,charlotte:!0,direct:!0,priority:1/0,firstDo:!0,filter:(e,player)=>d()&&a(player),async content(){var a;a=e,game.showJDTsImage(a,!0),_status.as_showImage_phase=a,_status.as_showImage_phase=s}}}),n.forEach(([event,e])=>{lib.skill[`_jdts_${event}`]={trigger:{player:event},silent:!0,charlotte:!0,direct:!0,priority:-1/0,lastDo:!0,filter:(e,player)=>d()&&a(player),async content(){var s;s=e,_status.as_showImage_phase===s&&(game.as_removeImage(),delete _status.as_showImage_phase)}}}),lib.skill._jdts_ddxy_respond={trigger:{player:"chooseToRespondBegin"},silent:!0,direct:!0,filter:(e,player)=>d()&&s(player)&&r(),async content(event,trigger){trigger._jd_ddxy=!0,game.showJDTsImage("ddxy",10)}},lib.skill._jdts_ddxy_sha={trigger:{target:"shaBegin"},silent:!0,charlotte:!0,forced:!0,filter:event=>d()&&s(event.target),async content(event,trigger){trigger._jd_ddxy=!0,game.showJDTsImage("ddxy",!0)}},lib.skill._jdts_ddxy_wuxie={trigger:{player:["useCardToBegin","phaseJudge"]},silent:!0,charlotte:!0,forced:!0,filter(event,player){if(event.card.storage?.nowuxie)return!1;const e=get.info(event.card);if(!1===e.wuxieable)return!1;if("phaseJudge"!==event.name){if(event.getParent().nowuxie)return!1;if(!event.target)return!!e.wuxieable;if(event.player.hasSkillTag("playernowuxie",!1,event.card))return!1;if("trick"!==get.type(event.card)&&!e.wuxieable)return!1}return s(player)&&r()},async content(event,trigger){trigger._jd_ddxy=!0,game.showJDTsImage("ddxy",!0)}},lib.skill._jdts_shan_used={trigger:{player:["useCard","respondAfter"]},silent:!0,charlotte:!0,forced:!0,filter:(event,player)=>s(player)&&"shan"===event.card.name,async content(event,trigger){trigger._jd_ddxy=!0,e()}},lib.skill._jdts_ddxy_end={trigger:{player:["chooseToRespondEnd","useCardToEnd","phaseJudgeEnd","respondSha","shanBegin"]},silent:!0,direct:!0,filter:(event,player)=>event._jd_ddxy&&s(player)&&r(),async content(){e()}},lib.skill._jdts_dfsk={trigger:{global:["phaseBegin","phaseEnd","phaseJudgeBegin","phaseDrawBegin","phaseUseBegin","phaseDiscardBegin"]},silent:!0,charlotte:!0,forced:!0,filter:()=>2===game.players.length&&_status.currentPhase!==game.me,async content(){game.showJDTsImage("dfsk",!0)}},lib.skill._jdts_clear={trigger:{global:["phaseEnd","useCardAfter"]},silent:!0,charlotte:!0,forced:!0,filter:(event,player)=>_status.currentPhase!==game.me&&player!==game.me,async content(){game.as_removeImage()}},lib.skill._jdts_die={trigger:{global:"dieAfter"},silent:!0,charlotte:!0,forced:!0,filter:(event,player)=>s(player)&&r(),async content(){game.as_removeImage()}}}export{d as initPhaseTipsSkills};
