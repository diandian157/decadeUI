import{ui,get,_status,lib}from"noname";function e(card,e,t,n){const a=n?.create||((e,t,n)=>{const a=document.createElement(n||"div");return e&&(a.className=e),t&&t.appendChild(a),a});let i=!1;card._tempSuitNum&&(i=!0);let s=card._tempSuitNum||ui.create.div(".tempsuitnum",card);card._tempSuitNum=s,i||(s.$num=a("num",s,"span"),s.$num.style.fontFamily='"STHeiti","SimHei","Microsoft JhengHei","Microsoft YaHei","WenQuanYi Micro Hei",Helvetica,Arial,sans-serif',s.$br=a(null,s,"br"),s.$suit=a("suit",s,"span"),s.$suit.style.fontFamily='"STHeiti","SimHei","Microsoft JhengHei","Microsoft YaHei","WenQuanYi Micro Hei",Helvetica,Arial,sans-serif'),s.$num.innerHTML=t?get.strNumber(t):"▣",s.$suit.innerHTML=e?get.translation(e):"◈",card.dataset.tempsn=e}const t={effect_caochuanjiejian:{key:"effect_caochuanjiejian"},shan:{key:"effect_shan"},tao:{key:"effect_tao",opts:{scale:.9}},tiesuo:{key:"effect_tiesuolianhuan",opts:{scale:.9}},jiu:{key:"effect_jiu",opts:{y:[-30,.5]}},kaihua:{key:"effect_shushangkaihua"},wuzhong:{key:"effect_wuzhongshengyou"},wuxie:{key:"effect_wuxiekeji",opts:{y:[10,.5],scale:.9}},nanman:{key:"effect_nanmanruqin",opts:{scale:.45}},wanjian:{key:"effect_wanjianqifa",opts:{scale:.78}},wugu:{key:"effect_wugufengdeng",opts:{y:[10,.5]}},taoyuan:{key:"SF_kapai_eff_taoyuanjieyi",opts:{y:[10,.5]}},shunshou:{key:"effect_shunshouqianyang"},huogong:{key:"effect_huogong",opts:{x:[8,.5],scale:.5}},guohe:{key:"effect_guohechaiqiao",opts:{y:[10,.5]}},yuanjiao:{key:"effect_yuanjiaojingong"},zhibi:{key:"effect_zhijizhibi"},zhulu_card:{key:"effect_zhulutianxia"}};function n(e,card){return{thunder:"effect_leisha",fire:"effect_huosha"}[e]||("red"===get.color(card)?"effect_hongsha":"effect_heisha")}function a(card,player,event,a){if(!card||!player||!event)return;const i=a.element?.create||((e,t)=>{const n=document.createElement("div");return e&&(n.className=e),t&&t.appendChild(n),n});let s,u=card.querySelector(".used-info");u||(u=card.appendChild(i("used-info"))),card.$usedtag=u,event.blameEvent&&(event=event.blameEvent),s="judge"===event.name?function(card,event,t){const n=event.judgestr+"的判定牌";return event.addMessageHook?.("judgeResult",function(){const n=this,a=n.result.card.clone,i=n.apcard;let s,u,c=a.querySelector(".used-info");c||(c=document.createElement("div"),c.className="used-info",a.appendChild(c)),n.result.suit===get.suit(a)&&n.result.number===get.number(a)||e(a,n.result.suit,n.result.number,t.element);const o=n.judge2;let r;u=o?o(n.result):t.get?.judgeEffect?.(n.judgestr,n.result.judge)??n.result.judge,u="boolean"==typeof u?u?1:-1:n.result.judge,u>=0?(s="play4",r="判定生效"):(s="play5",r="判定失效"),i?._ap&&i._ap.stopSpineAll(),i?._ap&&i===a?i._ap.playSpine({name:"effect_panding",action:s}):t.animation?.cap?.playSpineTo?.(a,{name:"effect_panding",action:s}),n.apcard=void 0,c.innerHTML=get.translation(n.judgestr)+r}),t.animation?.cap?.playSpineTo?.(card,{name:"effect_panding",action:"play",loop:!0}),event.apcard=card,n}(card,event,a):function(card,player,event,a){const i=_status.event;_status.event=event;let s=get.cardsetion?.(player)||"";if(_status.event=i,["useCard","respond"].includes(event.name)){const i=event.card.name,s=get.nature(event.card);if("off"!==lib.config.cardtempname&&(card.name!==i||!get.is.sameNature(s,card.nature,!0))){card._tempName||(card._tempName=ui.create.div(".temp-name",card));let e=get.translation(i);s&&"sha"===i&&(e=get.translation(s)+e),s&&(card._tempName.dataset.nature=s),card._tempName.innerHTML=e,card._tempName.tempname=e}const u=get.number(event.card),c=get.suit(event.card);if("1"===card.dataset.views||1!==event.card.cards?.length||card.number===u&&card.suit===c||e(card,c,u,a.element),event.card&&(!event.card.cards||!event.card.cards.length||1===event.card.cards.length)){const e=event.card.name,i=event.card.nature;if("sha"===e){const e=n(i,card);a.animation?.cap?.playSpineTo?.(card,e)}else{const n=t[e];n&&a.animation?.cap?.playSpineTo?.(card,n.key,n.opts)}}}return s}(card,player,event,a),u.innerHTML=s}export{t as cardEffectMap,e as cardTempSuitNum,n as getShaEffectKey,a as tryAddPlayerCardUseTag};
