import{lib,get,game}from"noname";function e(e){if(decadeUI.config.campIdentityImageMode)this._lastCampTask=this._lastCampTask||Promise.resolve(),this._lastCampTask=this._lastCampTask.then(async()=>{this.node.campWrap.node.campName.innerHTML="",this.node.campWrap.node.campName.style.backgroundImage="",this._finalGroup=e;const a=()=>{if("codename"!==decadeUI.config.newDecadeStyle&&this._finalGroup){const e=get.translation(this._finalGroup),a=get.plainText(e);this.node.campWrap.node.campName.innerHTML=a.length<=2?e:e.replaceAll(a,a[0])}else this.node.campWrap.node.campName.innerHTML=""},t=e=>new Promise((a,t)=>{const n=new Image;n.onload=()=>a(e),n.onerror=()=>t(e),n.src=e});if("onlineUI"!==decadeUI.config.newDecadeStyle){try{const a="off"===decadeUI.config.newDecadeStyle?"image/styles/shousha/name2_":"babysha"===decadeUI.config.newDecadeStyle?"image/styles/baby/hs_":"image/styles/decade/name_",n=decadeUIPath+a+e+".png";return await t(n),void(this.node.campWrap.node.campName.style.backgroundImage=`url("${n}")`)}catch{}try{const a=`group_${e}`,n=lib.card[a];if(!n?.image)throw new Error;let i;return i=n.image.startsWith("db:")?await game.getDB("image",n.image.slice(3)):n.image.startsWith("ext:")?`${lib.assetURL}${n.image.replace(/^ext:/,"extension/")}`:`${lib.assetURL}${n.image}`,await t(i),void(this.node.campWrap.node.campName.style.backgroundImage=`url("${i}")`)}catch{}a()}else a()});else if(this._finalGroup){const e=get.translation(this._finalGroup),a=get.plainText(e);this.node.campWrap.node.campName.innerHTML=a.length<=2?e:e.replaceAll(a,a[0])}else this.node.campWrap.node.campName.innerHTML=""}function a(){Object.defineProperties(lib.element.player,{group:{configurable:!0,get(){return this._group},set(a){a&&(this._group=a,this.node.campWrap.dataset.camp=get.character(this.name)?.groupBorder||a,e.call(this,a))}}})}export{a as definePlayerGroupProperty};
