import{game,get,lib}from"noname";import{getBasePlayerMethods as i}from"./base.js";const s=/* @__PURE__ */new Map;function n(n){if(i().$changeZhuanhuanji.apply(this,arguments),!get.is.zhuanhuanji(n,this))return;if(this.hiddenSkills.includes(n)&&this!==game.me)return;const t=this.node.xSkillMarks?.querySelector(`[data-id="${n}"]`);t&&(s.has(n)?(t.dk=function(i){return s.get(i)??!1}(n),e(this,t,n)):async function(i){if(s.has(i))return s.get(i);const n=`${lib.assetURL}extension/十周年UI/ui/assets/skill/shousha/zhuanhuanji/${i}_yang.png`;return new Promise(e=>{const t=new Image;t.onload=()=>{s.set(i,!0),e(!0)},t.onerror=()=>{s.set(i,!1),e(!1)},t.src=n})}(n).then(i=>{t.dk=i,e(this,t,n)}))}function e(player,i,s){"off"!==lib.config.extension_十周年UI_newDecadeStyle?function(i){i.classList.contains("yin")?(i.classList.remove("yin"),i.classList.add("yang")):(i.classList.remove("yang"),i.classList.add("yin"))}(i):function(player,i,s){const n="extension/十周年UI/ui/assets/skill/shousha/zhuanhuanji/",e=`${n}${s}_yang.png`,t=`${n}${s}_ying.png`,a=`${n}ditu_yang.png`,l=`${n}ditu_ying.png`;!0===i.dd?(player.setSkillYinYang(s,!1),i.dd=!1,i.setBackgroundImage(i.dk?e:a)):(player.setSkillYinYang(s,!0),i.dd=!0,i.setBackgroundImage(i.dk?t:l))}(player,i,s)}function t(i,s){game.broadcastAll((player,i,s)=>player.$setSkillYinYang(i,s),this,i,s)}function a(i,s){this.yangedSkills??=[],this.yingedSkills??=[],s?(this.yangedSkills.add(i),this.yingedSkills.remove(i)):(this.yingedSkills.add(i),this.yangedSkills.remove(i))}function l(i,s){game.broadcastAll((player,i,s)=>player.$setSkillState(i,s),this,i,s)}function o(i,s){switch(s){case"fail":!function(player,i){if(player.hiddenSkills.includes(i)&&player!==game.me)return;const s=player.node.xSkillMarks?.querySelector(`[data-id="${i}"]`);s&&s.classList.add("fail")}(this,i);break;case"shixiao":d(this,i,!0);break;case"unshixiao":d(this,i,!1)}}function d(player,i,s){player.shixiaoedSkills??=[],s?player.shixiaoedSkills.add(i):player.shixiaoedSkills.remove(i)}export{o as player$SetSkillState,a as player$SetSkillYinYang,n as playerChangeZhuanhuanji,l as playerSetSkillState,t as playerSetSkillYinYang};
