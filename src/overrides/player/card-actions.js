import{game,ui,get,_status}from"noname";import{playShowCardAudio as e,getBasePlayerMethods as t}from"./base.js";function n(){const event=t().useCard.apply(this,arguments);e(),event.pushHandler("decadeUI_TargetHighlight",(e,t)=>{"begin"!==t.state||1!==e.step||e.hideTargets||e.targets?.forEach(e=>e.classList.add("target"))});const n=event.finish;return event.finish=function(){n?.apply(this,arguments),this.targets?.forEach(e=>e.classList.remove("target"))},event}function s(){e();return t().respond.apply(this,arguments)}function a(){const e=t().lose.apply(this,arguments),event="loseAsync"===_status.event?.name?_status.event.getParent():_status.event;return"useCard"!==event?.name&&"respond"!==event?.name||(e.animate=!0,e.blameEvent=event),e}function r(event){const e=t();e.useCardAnimateBefore?.apply(this,arguments),l(event)&&(event.throw=!1)}function o(event){const e=t();e.respondAnimateBefore?.apply(this,arguments),l(event)&&(event.throw=!1)}function i(){t().$handleEquipChange.apply(this,arguments);if(this!==game.me||!ui.equipSolts)return;const e=Array.from(this.node.equips.childNodes).filter(card=>![1,2,3,4,5].includes(get.equipNum(card))).length;let n=e-Array.from(ui.equipSolts.back.children).filter(e=>"5"===e.dataset.type).length;if(n>0)for(;n>0;){n--;window.decadeUI.element.create(null,ui.equipSolts.back).dataset.type=5}else if(n<0)for(let t=0;t>e;t--){const e=Array.from(ui.equipSolts.back.children).find(e=>"5"===e.dataset.type);"5"===e?.dataset.type&&e.remove()}}function l(event){return!!event.lose_map&&Object.keys(event.lose_map).some(e=>"noowner"!==e&&event.lose_map[e].length>0)}export{i as playerHandleEquipChange,a as playerLose,s as playerRespond,o as playerRespondAnimateBefore,n as playerUseCard,r as playerUseCardAnimateBefore};
